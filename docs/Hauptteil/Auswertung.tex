\chapter{Auswertung}
\label{chap:auswertung}
In diesem Kapitel soll die Software anhand von für die Softwareentwicklung relevanten Qualitätsmerkmalen
ausgewertet werden. Laut Peter Liggesmeyer, dem Autor des Buches "Software-Qualität", sind diese
Korrektheit, Vollständigkeit, Sicherheit, Zuverlässigkeit, Verfügbarkeit und Robustheit \cite[S. 5]{SoftwareQualitaet}.
Die Arbeit fügt hier noch das Qualitätsmerkmal der Benutzerfreundlichkeit hinzu.

% Die Auswertung des umgesetzten Systems ist in folgende Bereiche aufgeteilt:
% Zuallererst werden die in \Cref{chap:anforderungsanalyse} die erarbeiteten Anforderungen
% mit dem Istzustand der umgesetzten Funktionalitäten anhand von Qualitätsmerkmalen verglichen. In \Cref{subsec:testabdeckung}
% wird die Testabdeckung beurteilt. Die Skalierbarkeit der Services wird in \Cref{sec:skalierbarkeitderservices}
% mithilfe von Lasttests ausgewertet. Mit den Lighthouse Tests in \Cref{sec:lighthousetests} wird die Frontendanwendung
% auf ihre Performanz, Zugänglichkeit, Suchmaschinenoptimierung und den Umfang der implementierten PWA-Funktionalitäten geprüft.
% Zuallererst wird in \Cref{sec:sicherheit} die Sicherheit der Infrastruktur und derer Komponenten ausgewertet.

\section{Korrektheit}
\label{sec:korrektheit}
Um die Korrektheit der Gesamtanwendung beurteilen zu können, muss das in der Anforderungsanalyse erwartete
Verhalten mit dem Verhalten des Istzustands verglichen werden. In der Anforderungsanalyse
in \Cref{chap:anforderungsanalyse} wurden allerdings hauptsächlich Funktionalitäten und weniger deren 
Verhalten behandelt. Da das Vorhalten der Software vor der Entwicklung des Konzepts nicht klar definiert wurde,
ist es schwer, die Korrektheit der Anwendung zu beurteilen. Die in der Konzept-Phase erarbeiteten Verfahren
wurden wie in dem Konzept entworfen auch in der Software schlussendlich umgesetzt. So wurden für
das Diagrammanordnungsverfahren ein vielfaches an Modultests implementiert, um das gewollte Verhalten auch in
der Anwendung sicherzustellen. Das in den Konzepten erarbeitete Verhalten weicht nicht von dem der späteren
Umsetzung ab. Dies ist auch für die Schritte des Datenstroms und den angeforderten Funktionalitäten der Fall.
Daraus ist zu schlussfolgern, dass die Software korrekt ist.

\section{Vollstandigkeit}
\label{sec:vollstaendigkeit}
Die Vollständigkeit der Software lässt sich einfach beurteilen. Hierfür müssen nur die in der Anforderungsanalyse
erarbeiteten Funktionalitäten mit denen des Istzustands verglichen werden. Die wichtigsten Funktionalitäten
wurden alle umgesetzt. So kann die Gesamtanwendung Daten beschaffen, verarbeiten, Diagrammen zuweisen und darstellen.
Da sich die Arbeit bei der Konzeption und Implementierung der Software auf die Qualitätsmerkmale Sicherheit,
Zuverlässigkeit, Verfügbarkeit und Robustheit fokussiert hat, konnten nicht alle angeforderten Implementierungsdetails
erfüllt werden. Die Authentifizierung, Rechteverwaltung, Sprachauswahl, Suche, Echtzeitübertragung der Daten wurden
voll funktionsfähig umgesetzt. Nicht oder nur bedingt wurde die Offline-Funktionalität, die Benachrichtigung
des Benutzers bei Übertretung eines vordefinierten Schwellwerts sowie die Filterung der Daten in den Diagrammen.
Die Offline-Funktionalität ist aktuell nur für statische Elemente der Anwendung gegeben. Die über das WebSocket-Protokoll
übertragenen Daten werden aktuell nicht in der progressiven Webanwendung gespeichert. Dies ist allerdings aus technischer
Sicht auch nur bedingt möglich, da das Speichervolumen von vom Browser bereitgestellten Speichermöglichkeiten
je nach Browser variiert und gerade auf mobilen Endgeräten oftmals sehr gering ausfällt \cite{HTML5RocksStorage}.
Die Benachrichtigung der Benutzer bei dem Übertreten eines vordefinierten Schwellwerts wurde noch nicht umgesetzt.
Die Funktionalität ist allerdings für die Zukunft geplant. Die Filterung der Daten ist bedingt möglich. So kann 
man mithilfe der von der Arbeit verwendeten Abfragesprache JMESPath, Daten anhand diverser Kriterien filtern.
Des Weiteren bietet die Visualisierungsbibliothek Chart.js bedingt Filtermöglichkeiten an. Ein selektives Filtern
an beispielsweise der Zeit ist allerdings nach aktuellem Stand innerhalb der Diagramme noch nicht umgesetzt worden.
Die Diagramme wurden allerdings so konzipiert, dass das Hinzufügen einer Filterfunktion
kein Problem darstellen sollte.

\section{Sicherheit}
\label{sec:sicherheit}
Auf die Sicherheit der Anwendung wurde besonders geachtet. So wurde wie bereits in der Implementierung erläutert, neben
der JWT-Authentisierung auch eine TwoZwei-Faktor-Authentisierung implementiert. Außerdem wurden in dem Resource Management Service
der Ein- und Ausgangsverkehr in beide Richtungen mithilfe des Koa Joi Routers validiert. Nichtsdestotrotz beinhaltet die Gesamtanwendung
noch Schwachstellen, die es zu eliminieren gilt. Die Authentifizierung passiert wie in der Implementierung beschrieben
über einen im HTTP-Header gesetzten JWT. Bei der WebSocket-Verbindung findet die Authentifizierung beim Handshake des
Verbindungsaufbaus statt. Die Verbindung wird somit nicht getrennt, wenn der Token abläuft. Die Frontendanwendung
schließt allerdings bei der Abmeldung eines Benutzers die WebSocket-Verbindung automatisch. Es wäre allerdings dennoch möglich,
dass bei einer erfolgreichen XSS-Attacke, die WebSocket-Verbindung aufrecht gehalten wird, um so Daten zu stehlen.

Ein weiterer Sachverhalt ist die Verwendung des \code{dangerouslySetInnerHTML} Feldes im React Frontend. Zur Verarbeitung
der Daten wird ein Syntax-Highlighter verwendet, um die Ein- und Ausgangsdaten in Form des JSON-Schemas anzuzeigen.
Da dieser allerdings in React zu langsam war, wurde er in nativem JavaScript implementiert und mithilfe des 
\code{dangerouslySetInnerHTML} Feldes in den React Code eingebunden. Im Falle, dass die externe, als Datenquelle
verwendete API, korrupte Daten ausliefert, könnten diese als Einstiegspunkt für eine XSS-Attacke verwendet werden.
Wenn man allerdings die angezeigten Zeilen der Ein- und Ausgangsdaten auf eine moderate Anzahl begrenzt, kann ein
in React geschriebener Syntax-Highlighter verwendet und somit die Schwachstelle umgangen werden. Die Arbeit plant
für die Zukunft, das JSON-Schema nie ganz anzuzeigen. Ziel ist es, das Schema stückchenweise aufzuklappen.

Der letzte Sicherheitsaspekt, den es anzusprechen gilt, ist die SSH-Verbindung aus der Pipeline heraus zu den Produktionsservern.
Hat ein Eindringling Zugriff auf die Pipeline, hat er gleichzeitig Zugriff auf alle Produktionsserver. 
Um dies zu vermeiden, können sogenannte WebHooks verwendet werden. So könnte die Pipeline eine Nachricht via WebHook an
den Produktionsserver senden, der daraufhin die Docker-Images mit denen aus der Docker Registry austauscht.

\subsection{Testabdeckung}
\label{subsec:testabdeckung}




% Probleme: cookies verändern sich, Service Worker verändert sich, neue Felder in der Datenbank
% Frontend und Backend etc, also allen verschiedenen Services

\section{Skalierbarkeit der Services}
\label{sec:skalierbarkeitderservices}

\subsection{Lasttests}
\label{subsec:lasttests}

% stress test
% edurance or consistent load tests => memory leaks, memory full because of logging
% baseline test - compare tests over time




\section{Lighthouse Tests}
\label{sec:lighthousetests}

Steve Souders betont
in einem Vortrag über die Performanz von JavaScript, dass ein Drittel der im Browser
geladenen First-Party-Scripts zwischen 90- und 100Kb nicht komprimiert werden.
Das liege daran, dass jQuery, eine der meistgenutztesten JS-Bibliotheken,
unkomprimiert circa bei 100Kb angesiedelt sei.\cite{SteveSoudersMakeJavaScriptFaster}
Laut einer Statistik von Build With benutzten 88,07\% der Top 10k meinstbesuchtesten
Webseiten des Internets jQuery.\footnote{Stand Februar 2020.\cite{BuildWithjQuery}}

Um die Relevanz der Kompression von Daten zu verdeutlichen, führt diese Arbeit einen
Vergleichstest des initialen Ladevorgangs der Frontendanwendung,
einmal mit Gzip, Brotli und einmal ohne Kompression durch.

Die Leistungstests
werden mit dem Open-Source-Werkzeug Lighthouse durchgeführt.\footnote{https://developers.google.com/web/tools/lighthouse}
Um den Unterschied der benötigten Zeit zum initialen Laden der Frontendanwendung
besser zu verdeutlichen, wird der Datendurchlauf auf 1.638,4Kbps verringert.
Die Frontendanwendung wird in einem nachgeahmten Nexus 5X ausgeführt.
Für die Analyse wurden vier Metriken aus dem Testbericht entnommen.
Die Ergebnisse des Leistungstests sind in Abbildung \ref{tab:lighthouseleistungstestdesinitialenladevorgangs}
dargestellt.

\begin{table}[h]
\begin{center}
\begin{tabular}{l*{8}{r}}
Metrik & Ohne Kompr. & Gzip & Brotli \\
\hline
Erstes Zeichnen von Inhalten & 6,2s  & 3,1s & 2,9s \\
Erste CPU-Inaktivität        & 6,2s  & 4,3s & 4,1s \\
Zeit für Interaktion         & 7,5s  & 4,3s & 4,1s \\
Übertragungsgröße            & 1.172KB  &  553KB & 481KB \\
\end{tabular}
\end{center}
\caption{Lighthouse Leistungstest des initialen Ladevorgangs}
\label{tab:lighthouseleistungstestdesinitialenladevorgangs}
\end{table}

Die Zeit wird von der ersten vom Browser ausgehenden Anfrage gemessen.
Lighthouse beschreibt die Metriken wie folgt: Unter dem ersten Zeichnen
von Inhalten versteht man den ersten Zeitpunkt, an dem der Browser
irgendeinen Inhalt zeichnet. Die erste CPU-Inaktivität ist
der erste Zeitpunkt, an dem die Seite auf Benutzerinteraktionen reagieren könnte.
Unter Zeit für Interaktion versteht man den Zeitpunkt, an dem alle Inhalte geladen ist.
Jetzt kann die Seite zu jeder Interaktion schnell reagieren.\cite{WhatPerformanceMetricsMeasure}

In Abbildung \ref{tab:lighthouseleistungstestdesinitialenladevorgangs} wird klar deutlich,
dass Kompression gerade bei langsameren Internetverbindungen von großer Bedeutung ist.
Es ist wichtig anzumerken, dass der Brotli-Kompressionsalgorithmus zwar eine größere
Kompressionsrate besitzt, allerdings für die Kompression und Dekompression mehr Zeit
benötigt.\cite{CompressionBenchmark} Für dynamische Inhalte sollte man also Gzip
benutzen. Wichtig ist auch, dass Bilder je nach Format in der Regel bereits komprimiert wurden.
Ein weiterer Kompressionsvorgang kann die Größe der Bilder vergrößern.

\section{Sicherheit}
\label{sec:sicherheit}


